---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
    echo : false
---

```{r, message=F, warning=F}
require(dplyr)
require(ggplot2)
require(grid)
require(gridExtra)
```

## Loading and preprocessing the data

```{r}

rawData <- read.csv('activity.csv', header=TRUE)
summary(rawData)

```

## What is mean total number of steps taken per day?

```{r}

rawData <- rawData %>%
        mutate(parsedDate = as.Date(date, "%Y-%m-%d"))

dayData <- rawData %>%
        group_by(parsedDate) %>%
                summarise(daySum = sum(steps, na.rm=TRUE))
                 
p1 <- ggplot(dayData) +
        geom_histogram(aes(x=parsedDate, y=daySum, fill=daySum), stat="identity") +
        scale_fill_gradient("Steps", low = "green", high = "red") +
        labs(x="Date", y="Steps")

print(p1)

```

The value of the mean per day is calculated with this statement:

```{r} 
meanValue <- mean(dayData$daySum) 
``` 

and the values is `r meanValue ` (Steps / Day) 

For the median value is used:

```{r} 
medianValue <- median(dayData$daySum)
```

and the value is `r medianValue ` (Steps / Day) 

## What is the average daily activity pattern?

```{r} 

avgPattern <- rawData %>%
        group_by(interval) %>%
        summarise(avgStep = mean(steps, na.rm=TRUE))

ggplot(avgPattern, aes(interval, avgStep)) +
        geom_line(colour = "red", size = 1) +
        labs(x="Interval", y="AVG of Steps")

```

```{r}

intervalMax <- avgPattern[which.max(avgPattern$avgStep),]$interval
maxSteps <- avgPattern[avgPattern == intervalMax,]$avgStep

```

At interval `r intervalMax  ` we have the maximum value> `r maxSteps `

## Imputing missing values

total number of 'NA' values is `r sum(is.na(rawData$steps))  `

```{r}

replaceNaData <- rawData %>%
        group_by(parsedDate) %>%
                transform(steps = 
                        ifelse(is.na(steps), 
                                mean(steps, na.rm=TRUE), 
                                steps))

dayDataWithNoNa <- replaceNaData %>%
        group_by(parsedDate) %>%
                summarise(daySumWithNoNa = sum(steps, na.rm=TRUE))
                 
p2 <- ggplot(dayDataWithNoNa) +
        geom_histogram(
                aes(x=parsedDate, 
                    y=daySumWithNoNa, 
                    fill=daySumWithNoNa),
                stat="identity") +
        scale_fill_gradient("Steps", low = "green", high = "red") +
        labs(x="Date", y="Steps")

print(p2)

```

The value of the mean per day int the dataset without NAs is calculated with this statement:

```{r} 
meanValue2 <- mean(dayDataWithNoNa$daySumWithNoNa) 
``` 

and the values is `r meanValue2 ` (Steps / Day) 

For the median value is used:

```{r} 
medianValue2 <- median(dayDataWithNoNa$daySumWithNoNa)
```

and the value is `r medianValue2 ` (Steps / Day) 

###Now a comparision between rawData and 'NA' replaced Data.

```{r}

p1 <- p1 +
        theme(legend.position="none") 

p2 <- p2 +
        theme(legend.position="none") +
        ylab("")

grid.arrange(p1, p2, nrow=1, ncol=2)

```

## Are there differences in activity patterns between weekdays and weekends?
